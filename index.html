<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>편집단가 계산기 초벌용</title>
  <style>
    :root{
      --bg:#0b0f14; --panel:#121821; --muted:#2a3442; --text:#e6edf3; --accent:#5eb6ff; --ok:#19c37d; --warn:#ffcc66; --danger:#ff6b6b;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Apple SD Gothic Neo,"Apple SD 산돌고딕 Neo",Arial; background:var(--bg); color:var(--text);}
    header{position:sticky;top:0;z-index:5;background:linear-gradient(180deg,rgba(11,15,20,.95),rgba(11,15,20,.65));backdrop-filter: blur(6px);}
    .wrap{max-width:1100px;margin:0 auto;padding:16px 20px}
    h1{margin:8px 0 4px;font-size:24px;letter-spacing:-.3px}
    .subtitle{opacity:.7;margin:0 0 12px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
    .card{grid-column:span 12;background:var(--panel);border:1px solid #1b2430;border-radius:14px;padding:14px 14px 10px}
    .split{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .row{display:flex;align-items:center;gap:10px;margin:8px 0}
    label{min-width:180px;font-weight:600}
    input[type="number"], select{background:#0f1520;border:1px solid var(--muted);color:var(--text);padding:8px 10px;border-radius:10px;outline:none;width:100%}
    input[type="checkbox"]{transform:scale(1.2)}
    .muted{color:#9fb0c2}
    .disabled{opacity:.45;filter:grayscale(.3)}
    .badge{display:inline-block;padding:4px 8px;border-radius:999px;font-size:12px;font-weight:700}
    .badge.ok{background:rgba(25,195,125,.12);color:var(--ok);border:1px solid rgba(25,195,125,.35)}
    .badge.warn{background:rgba(255,204,102,.12);color:var(--warn);border:1px solid rgba(255,204,102,.35)}
    .badge.danger{background:rgba(255,107,107,.12);color:var(--danger);border:1px solid rgba(255,107,107,.35)}
    .total{display:flex;align-items:baseline;gap:14px}
    .total strong{font-size:36px;letter-spacing:-.5px}
    .total small{opacity:.7}
    .pill{background:#0c1420;border:1px solid #1b2430;padding:8px 10px;border-radius:999px}
    .kicker{font-size:12px;opacity:.8}
    .hr{height:1px;background:linear-gradient(90deg,transparent,#253044,transparent);margin:10px 0}
    .stack{display:flex;flex-direction:column;gap:8px}
    .col2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .note{background:#0e1522;border:1px dashed #27405f;border-radius:10px;padding:10px;font-size:13px}
    .footer{opacity:.6;font-size:12px;margin-top:10px}
    .range{display:flex;gap:8px}
    .range input{width:100%}
    .mini{width:110px}
    button.copy{background:#172233;border:1px solid #28364c;color:#cfe7ff;padding:8px 12px;border-radius:10px;cursor:pointer}
    .field-help{font-size:12px;opacity:.78;margin-top:4px}
    @media (max-width:640px){
      .wrap{padding:12px 14px}
      .total{flex-direction:column;align-items:flex-start;gap:6px}
      .total strong{font-size:28px}
      .card{padding:12px}
      .row{flex-direction:column;align-items:stretch}
      label{min-width:0;font-size:14px}
      input[type="number"], select{padding:12px 12px}
      .mini{width:100%}
      .col2{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap total">
      <div>
        <div class="kicker">최종 단가</div>
        <strong id="total">0원</strong>
        <small id="minuteInfo" class="pill">분당 0원 × 0분</small>
      </div>
      <div class="badge ok" id="statusBadge">초벌 계산</div>
    </div>
  </header>

  <main class="wrap">
    <section class="grid">
      <div class="card">
        <h2>입력</h2>
        <div class="hr"></div>
        <div class="stack">
          <div class="row">
            <label>유튜브 편집</label>
            <select id="isYoutube">
              <option value="Y">O</option>
              <option value="N">X</option>
            </select>
          </div>

          <div class="row">
            <label>자료화면 있음</label>
            <select id="hasBroll">
              <option value="Y">O</option>
              <option value="N" selected>X</option>
            </select>
          </div>

          <div id="brollBlock" class="stack disabled">
            <div class="row">
              <label>자료화면 종류</label>
              <select id="brollType" disabled>
                <option value="photo">사진</option>
                <option value="video">영상</option>
                <option value="both">둘다</option>
              </select>
            </div>
            <div class="row">
              <label>자료화면 갯수</label>
              <input id="brollCount" type="number" min="0" step="1" value="0" class="mini" disabled />
            </div>
          </div>

          <div class="row">
            <label>총 출연자</label>
            <input id="talents" type="number" min="1" step="1" value="1" class="mini" />
          </div>

          <div class="row">
            <label>총 분량 (분)</label>
            <div class="col2" style="flex:1">
              <div class="row" style="gap:6px">
                <span class="muted">최소</span>
                <input id="minLen" type="number" min="1" step="1" value="7" />
                <span class="muted">분</span>
              </div>
              <div class="row" style="gap:6px">
                <span class="muted">최대</span>
                <input id="maxLen" type="number" min="1" step="1" value="10" />
                <span class="muted">분</span>
              </div>
            </div>
            <div class="field-help">평균값으로 계산합니다 (예: 7~10분 → 8.5분)</div>
          </div>

          <div class="row">
            <label>사용된 카메라 대수</label>
            <input id="cams" type="number" min="1" step="1" value="1" class="mini" />
          </div>

          <div class="row">
            <label>외부 오디오트랙</label>
            <select id="extAudio">
              <option value="Y">유</option>
              <option value="N" selected>무</option>
            </select>
          </div>

          <div class="row">
            <label>오디오 믹싱여부</label>
            <select id="mixing">
              <option value="none" selected>없어도 됨</option>
              <option value="simple">간단한 볼륨조절</option>
              <option value="balance">밸런스를 맞추고 연출 필요</option>
            </select>
          </div>

          <div class="row">
            <label>원본 소스 시간</label>
            <div class="row" style="gap:6px">
              <input id="srcHour" type="number" min="0" step="1" value="0" class="mini" />
              <span class="muted">시간</span>
              <input id="srcMin" type="number" min="0" max="59" step="1" value="30" class="mini" />
              <span class="muted">분</span>
            </div>
          </div>

          <div class="row">
            <label>로고 유무</label>
            <select id="hasLogo">
              <option value="Y" selected>유</option>
              <option value="N">무</option>
            </select>
          </div>

          <div class="row">
            <label>타이틀 유무</label>
            <select id="hasTitle">
              <option value="Y" selected>유</option>
              <option value="N">무</option>
            </select>
          </div>

          <div class="row">
            <label>자막 난이도</label>
            <select id="subtitleLevel">
              <option value="low" selected>하</option>
              <option value="mid">중</option>
              <option value="high">상</option>
            </select>
          </div>
        </div>
      </div>

      <div class="card">
        <h2>결과</h2>
        <div class="hr"></div>
        <div id="warnings" class="stack"></div>
        <div class="hr"></div>
        <div class="stack">
          <div class="row"><label>분당 기본단가</label><div id="rowBase"></div></div>
          <div class="row"><label>분당 추가(자료/출연/카메라/소스/자막/믹싱)</label><div id="rowPerMinAdds"></div></div>
          <div class="row"><label>적용 분량</label><div id="rowMinutes"></div></div>
          <div class="row"><label>총액 가산(자료 갯수/오디오/믹싱)</label><div id="rowMultipliers"></div></div>
          <div class="hr"></div>
          <div class="row"><label>계산식</label><div id="formula" class="muted"></div></div>
        </div>
      </div>
    </section>

    <section class="footer">
      <div>ⓘ 초벌 견적 용도의 계산기입니다. 실제 견적은 프로젝트 성격/일정/검수 횟수 등에 따라 변동될 수 있습니다.</div>
      <div style="margin-top:6px">GitHub Pages 배포: 이 파일을 리포지토리에 <code>index.html</code>로 커밋 → Settings → Pages → Branch 지정 후 접속.</div>
      <div style="margin-top:8px"><button class="copy" id="copyJSON">설정값 JSON 복사</button></div>
    </section>
  </main>

  <script>
    const fmt = n => (Math.round(n)).toLocaleString('ko-KR') + '원';

    const els = {
      isYoutube: document.getElementById('isYoutube'),
      hasBroll: document.getElementById('hasBroll'),
      brollBlock: document.getElementById('brollBlock'),
      brollType: document.getElementById('brollType'),
      brollCount: document.getElementById('brollCount'),
      talents: document.getElementById('talents'),
      minLen: document.getElementById('minLen'),
      maxLen: document.getElementById('maxLen'),
      cams: document.getElementById('cams'),
      extAudio: document.getElementById('extAudio'),
      mixing: document.getElementById('mixing'),
      srcHour: document.getElementById('srcHour'),
      srcMin: document.getElementById('srcMin'),
      hasLogo: document.getElementById('hasLogo'),
      hasTitle: document.getElementById('hasTitle'),
      subtitleLevel: document.getElementById('subtitleLevel'),
      total: document.getElementById('total'),
      minuteInfo: document.getElementById('minuteInfo'),
      statusBadge: document.getElementById('statusBadge'),
      warnings: document.getElementById('warnings'),
      rowBase: document.getElementById('rowBase'),
      rowPerMinAdds: document.getElementById('rowPerMinAdds'),
      rowMinutes: document.getElementById('rowMinutes'),
      rowMultipliers: document.getElementById('rowMultipliers'),
      formula: document.getElementById('formula'),
      copyJSON: document.getElementById('copyJSON'),
    };

    function setBrollEnabled() {
      const on = els.hasBroll.value === 'Y';
      els.brollBlock.classList.toggle('disabled', !on);
      for (const el of els.brollBlock.querySelectorAll('select,input')){
        el.disabled = !on;
      }
    }

    function getMinutes(){
      let min = Number(els.minLen.value||0);
      let max = Number(els.maxLen.value||0);
      if (min<1) min=1; if (max<min) max=min;
      const avg = (min+max)/2;
      return {min, max, avg};
    }

    function perMinuteCalc(){
      let base = (els.isYoutube.value==='Y') ? 5000 : 0;
      let add = 0;

      // 자료화면 종류 (분당)
      if (els.hasBroll.value==='Y'){
        add += 1500;
        const t = els.brollType.value;
        if (t==='photo') add += 500;
        else if (t==='video') add += 1000;
        else if (t==='both') add += 1200;
      }

      // 출연자 (분당)
      const talents = Number(els.talents.value||1);
      if (talents>=2 && talents<=3) add += 1500;
      else if (talents>=4) add += 2500;

      // 카메라 (분당)
      const cams = Number(els.cams.value||1);
      if (cams===3) add += 2000; else if (cams>=4) add += 5000;

      // 원본 소스 시간 (분당)
      const h = Number(els.srcHour.value||0);
      const m = Number(els.srcMin.value||0);
      const totalMins = h*60 + m;
      if (totalMins>60 && totalMins<=180) add += 1400;
      else if (totalMins>180) add += 3000;

      // 자막 난이도 (분당)
      const sub = els.subtitleLevel.value;
      if (sub==='high') add += 4000; else if (sub==='mid') add += 2000;

      // 오디오 믹싱 (분당 or 총액)
      if (els.mixing.value==='balance') add += 2000; // 분당 추가

      return { base, add, perMin: base + add };
    }

    function totalCalc(){
      setBrollEnabled();

      const {min, max, avg} = getMinutes();
      const {base, add, perMin} = perMinuteCalc();
      let total = perMin * avg;

      // 총액 가산 (자료화면 갯수 / 외부 오디오 / 간단 믹싱)
      const multipliers = [];

      if (els.hasBroll.value==='Y'){
        const c = Number(els.brollCount.value||0);
        if (c>=1 && c<=12){ total *= 1.20; multipliers.push('+20% (자료 1~12개)'); }
        else if (c>=13 && c<=40){ total *= 1.45; multipliers.push('+45% (자료 13~40개)'); }
        else if (c>=41){ total *= 1.65; multipliers.push('+65% (자료 41개~)'); }
      }

      if (els.extAudio.value==='Y'){ total *= 1.05; multipliers.push('+5% (외부 오디오트랙)'); }
      if (els.mixing.value==='simple'){ total *= 1.08; multipliers.push('+8% (간단 볼륨조절)'); }

      // 상단 표시
      els.total.textContent = fmt(total);
      els.minuteInfo.textContent = `분당 ${fmt(perMin)} × ${avg.toFixed(1)}분`;
      els.statusBadge.textContent = '자동 계산 중';

      // 경고/안내
      const warns = [];
      if (els.hasLogo.value==='N') warns.push('<span class="badge warn">로고 제작비 별도 협의</span>');
      if (els.hasTitle.value==='N') warns.push('<span class="badge warn">오프닝 타이틀 제작비 별도 협의</span>');
      if (els.isYoutube.value==='N') warns.push('<span class="badge danger">유튜브 편집 X → 기본 분당 0원(별도 기준 필요)</span>');
      els.warnings.innerHTML = warns.length? `<div class="note">${warns.join(' ')}<br><span class="muted">※ 추가 제작비는 현재 총액에 포함되지 않습니다.</span></div>` : '<div class="note">특이사항 없음</div>';

      // 행별 요약
      els.rowBase.textContent = fmt(base);
      els.rowPerMinAdds.textContent = `+ ${fmt(add)} → 분당 ${fmt(perMin)}`;
      els.rowMinutes.textContent = `${min}~${max}분 (평균 ${avg.toFixed(1)}분)`;
      els.rowMultipliers.textContent = multipliers.length? multipliers.join(' / ') : '가산 없음';

      els.formula.textContent = `(${fmt(base)} + 분당 추가 ${fmt(add)}) × 평균분 ${avg.toFixed(1)} × 가산계수(${ multipliers.length? multipliers.join(' · ').replaceAll('+','') : '1.00' })`;

      return {total, perMin, base, add, avgMinutes: avg, multipliers};
    }

    function bind(){
      document.querySelectorAll('input,select').forEach(el => el.addEventListener('input', totalCalc));
      els.copyJSON.addEventListener('click', ()=>{
        const {avg} = getMinutes();
        const h = Number(els.srcHour.value||0); const m = Number(els.srcMin.value||0);
        const payload = {
          isYoutube: els.isYoutube.value==='Y',
          hasBroll: els.hasBroll.value==='Y',
          brollType: els.brollType.value,
          brollCount: Number(els.brollCount.value||0),
          talents: Number(els.talents.value||1),
          minutes: {min: Number(els.minLen.value||0), max: Number(els.maxLen.value||0), avg},
          cameras: Number(els.cams.value||1),
          externalAudioTrack: els.extAudio.value==='Y',
          mixing: els.mixing.value,
          sourceDuration: {hours: h, minutes: m, totalMinutes: h*60+m},
          hasLogo: els.hasLogo.value==='Y',
          hasTitle: els.hasTitle.value==='Y',
          subtitleLevel: els.subtitleLevel.value,
          snapshot: totalCalc()
        };
        const text = JSON.stringify(payload, null, 2);
        navigator.clipboard.writeText(text).then(()=>{
          els.statusBadge.textContent = '설정 JSON 복사됨';
        });
      });
      setBrollEnabled();
      totalCalc();
    }

    bind();
  </script>
</body>
</html>
