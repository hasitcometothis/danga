<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>편집단가 계산기 초벌용</title>
  <style>
    :root{
      --bg:#0b0f14; --panel:#121821; --muted:#2a3442; --text:#e6edf3; --accent:#5eb6ff; --ok:#19c37d; --warn:#ffcc66; --danger:#ff6b6b;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Apple SD Gothic Neo,"Apple SD 산돌고딕 Neo",Arial; background:var(--bg); color:var(--text);}
    header{position:sticky;top:0;z-index:5;background:linear-gradient(180deg,rgba(11,15,20,.95),rgba(11,15,20,.65));backdrop-filter: blur(6px);}
    .wrap{max-width:1100px;margin:0 auto;padding:16px 20px}
    h1{margin:8px 0 4px;font-size:24px;letter-spacing:-.3px}
    .subtitle{opacity:.7;margin:0 0 12px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
    .card{grid-column:span 12;background:var(--panel);border:1px solid #1b2430;border-radius:14px;padding:14px 14px 10px}
    .split{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .row{display:flex;align-items:center;gap:10px;margin:8px 0}
    label{min-width:180px;font-weight:600}
    input[type="number"], select{background:#0f1520;border:1px solid var(--muted);color:var(--text);padding:8px 10px;border-radius:10px;outline:none;width:100%}
    input[type="checkbox"]{transform:scale(1.2)}
    .muted{color:#9fb0c2}
    .disabled{opacity:.45;filter:grayscale(.3)}
    .badge{display:inline-block;padding:4px 8px;border-radius:999px;font-size:12px;font-weight:700}
    .badge.ok{background:rgba(25,195,125,.12);color:var(--ok);border:1px solid rgba(25,195,125,.35)}
    .badge.warn{background:rgba(255,204,102,.12);color:var(--warn);border:1px solid rgba(255,204,102,.35)}
    .badge.danger{background:rgba(255,107,107,.12);color:var(--danger);border:1px solid rgba(255,107,107,.35)}
    .total{display:flex;align-items:baseline;gap:14px}
    .total strong{font-size:36px;letter-spacing:-.5px}
    .total small{opacity:.7}
    .pill{background:#0c1420;border:1px solid #1b2430;padding:8px 10px;border-radius:999px}
    .kicker{font-size:12px;opacity:.8}
    .hr{height:1px;background:linear-gradient(90deg,transparent,#253044,transparent);margin:10px 0}
    .stack{display:flex;flex-direction:column;gap:8px}
    .col2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .note{background:#0e1522;border:1px dashed #27405f;border-radius:10px;padding:10px;font-size:13px}
    .footer{opacity:.6;font-size:12px;margin-top:10px}
    .range{display:flex;gap:8px}
    .range input{width:100%}
    .mini{width:110px}
    button.copy{background:#172233;border:1px solid #28364c;color:#cfe7ff;padding:8px 12px;border-radius:10px;cursor:pointer}
    .field-help{font-size:12px;opacity:.78;margin-top:4px}
    @media (max-width:640px){
      .wrap{padding:12px 14px}
      .total{flex-direction:column;align-items:flex-start;gap:6px}
      .total strong{font-size:28px}
      .card{padding:12px}
      .row{flex-direction:column;align-items:stretch}
      label{min-width:0;font-size:14px}
      input[type="number"], select{padding:12px 12px}
      .mini{width:100%}
      .col2{grid-template-columns:1fr}
    }
    .confirm{background:#1a66ff;border:1px solid #2b5bdc;color:#fff;padding:12px 16px;border-radius:12px;font-weight:700;cursor:pointer}
    .confirm:active{transform:translateY(1px)}
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;padding:20px}
    .modal.hidden{display:none}
    .modal-card{background:#0f1520;border:1px solid #2a3442;border-radius:16px;max-width:520px;width:100%;padding:24px;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,.5)}
    .modal-title{font-size:22px;margin-bottom:6px}
    .modal-text{opacity:.85;margin-bottom:14px}
    .roulette{font-size:40px;font-weight:900;letter-spacing:-.5px;margin:6px 0 18px}
    @media (max-width:640px){
      .roulette{font-size:32px}
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>편집단가 계산기 초벌용</h1>
      
    </div>
  </header>

  <main class="wrap">
    <section class="grid">
      <div class="card">
        <h2>입력</h2>
        <div class="hr"></div>
        <div class="stack">
          <div class="row">
            <label>유튜브 편집</label>
            <select id="isYoutube">
              <option value="Y">O</option>
              <option value="N">X</option>
            </select>
          </div>

          <div class="row">
            <label>자료화면 있음</label>
            <select id="hasBroll">
              <option value="Y">O</option>
              <option value="N" selected>X</option>
            </select>
          </div>

          <div id="brollBlock" class="stack disabled">
            <div class="row">
              <label>자료화면 종류</label>
              <select id="brollType" disabled>
                <option value="photo">사진</option>
                <option value="video">영상</option>
                <option value="both">둘다</option>
              </select>
            </div>
            <div class="row">
              <label>자료화면 갯수</label>
              <input id="brollCount" type="number" min="0" step="1" value="0" class="mini" disabled />
            </div>
          </div>

          <div class="row">
            <label>총 출연자</label>
            <input id="talents" type="number" min="1" step="1" value="1" class="mini" />
          </div>

          <div class="row">
            <label>총 분량 (분)</label>
            <div class="col2" style="flex:1">
              <div class="row" style="gap:6px">
                <span class="muted">최소</span>
                <input id="minLen" type="number" min="1" step="1" value="7" />
                <span class="muted">분</span>
              </div>
              <div class="row" style="gap:6px">
                <span class="muted">최대</span>
                <input id="maxLen" type="number" min="1" step="1" value="10" />
                <span class="muted">분</span>
              </div>
            </div>
            <div class="field-help">평균값으로 계산합니다 (예: 7~10분 → 8.5분)</div>
          </div>

          <div class="row">
            <label>사용된 카메라 대수</label>
            <input id="cams" type="number" min="1" step="1" value="1" class="mini" />
          </div>

          <div class="row">
            <label>외부 오디오트랙</label>
            <select id="extAudio">
              <option value="Y">유</option>
              <option value="N" selected>무</option>
            </select>
          </div>

          <div class="row">
            <label>오디오 믹싱여부</label>
            <select id="mixing">
              <option value="none" selected>없어도 됨</option>
              <option value="simple">간단한 볼륨조절</option>
              <option value="balance">밸런스를 맞추고 연출 필요</option>
            </select>
          </div>

          <div class="row">
            <label>원본 소스 시간</label>
            <div class="row" style="gap:6px">
              <input id="srcHour" type="number" min="0" step="1" value="0" class="mini" />
              <span class="muted">시간</span>
              <input id="srcMin" type="number" min="0" max="59" step="1" value="30" class="mini" />
              <span class="muted">분</span>
            </div>
          </div>

          <div class="row">
            <label>로고 유무</label>
            <select id="hasLogo">
              <option value="Y" selected>유</option>
              <option value="N">무</option>
            </select>
          </div>

          <div class="row">
            <label>타이틀 유무</label>
            <select id="hasTitle">
              <option value="Y" selected>유</option>
              <option value="N">무</option>
            </select>
          </div>
      <div class="card" id="confirmCard" style="margin-top:0;">
        <button id="confirmBtn" class="confirm" type="button">확인</button>
      </div>

      </div>
    </section>

    <section class="footer">
      <div>건전한 산업을 위해 <strong>최소한으로 계산된 단가보다 30% 이상</strong> 지급 부탁드립니다.</div>
    </section>
    <!-- 결과 팝업 -->
    <div id="resultModal" class="modal hidden" role="dialog" aria-modal="true">
      <div class="modal-card">
        <div class="modal-title">짜잔!</div>
        <div class="modal-text">당신이 작업자에게 의뢰할 수 있는 적절한 단가는</div>
        <div id="rouletteNumber" class="roulette">0원</div>
        <button id="closeModal" class="confirm">닫기</button>
      </div>
    </div>
  </main>

  <script>
    const fmt = n => (Math.round(n)).toLocaleString('ko-KR') + '원';

    const els = {
      isYoutube: document.getElementById('isYoutube'),
      hasBroll: document.getElementById('hasBroll'),
      brollBlock: document.getElementById('brollBlock'),
      brollType: document.getElementById('brollType'),
      brollCount: document.getElementById('brollCount'),
      talents: document.getElementById('talents'),
      minLen: document.getElementById('minLen'),
      maxLen: document.getElementById('maxLen'),
      cams: document.getElementById('cams'),
      extAudio: document.getElementById('extAudio'),
      mixing: document.getElementById('mixing'),
      srcHour: document.getElementById('srcHour'),
      srcMin: document.getElementById('srcMin'),
      hasLogo: document.getElementById('hasLogo'),
      hasTitle: document.getElementById('hasTitle'),
      subtitleLevel: document.getElementById('subtitleLevel'),
      confirmBtn: document.getElementById('confirmBtn'),
      modal: document.getElementById('resultModal'),
      closeModal: document.getElementById('closeModal'),
      roulette: document.getElementById('rouletteNumber'),
    };

    function setBrollEnabled() {
      const on = els.hasBroll.value === 'Y';
      els.brollBlock.classList.toggle('disabled', !on);
      for (const el of els.brollBlock.querySelectorAll('select,input')){
        el.disabled = !on;
      }
    }

    function getMinutes(){
      let min = Number(els.minLen.value||0);
      let max = Number(els.maxLen.value||0);
      if (min<1) min=1; if (max<min) max=min;
      const avg = (min+max)/2;
      return {min, max, avg};
    }

    function perMinuteCalc(){
      let base = (els.isYoutube.value==='Y') ? 5000 : 0;
      let add = 0;

      // 자료화면 종류 (분당)
      if (els.hasBroll.value==='Y'){
        add += 1500;
        const t = els.brollType.value;
        if (t==='photo') add += 500;
        else if (t==='video') add += 1000;
        else if (t==='both') add += 1200;
      }

      // 출연자 (분당) — 1명:+5000, 2-3명:+5000+4500, 4+:+5000+10000
      const talents = Number(els.talents.value||1);
      if (talents===1) add += 5000;
      else if (talents>=2 && talents<=3) add += (5000 + 4500);
      else if (talents>=4) add += (5000 + 10000);

      // 카메라 (분당) — 1대:0, 2-3대:+15000, 4+:+30000
      const cams = Number(els.cams.value||1);
      if (cams>=2 && cams<=3) add += 15000; else if (cams>=4) add += 30000;

      // 원본 소스 시간: 분당 추가 제거 (총액에서 비율 가산으로 처리)

      // 자막 난이도 (분당) — 상:+40000, 중:+25000, 하:+0
      const sub = els.subtitleLevel ? els.subtitleLevel.value : 'low';
      if (sub==='high') add += 40000; else if (sub==='mid') add += 25000;

      // 오디오 믹싱 — 연출 필요: 분당 +4000 (추가로 총액 20%는 totalCalc에서)
      if (els.mixing.value==='balance') add += 4000; 

      return { base, add, perMin: base + add };
    }

    function totalCalc(){
      setBrollEnabled();

      const {min, max, avg} = getMinutes();
      const {base, add, perMin} = perMinuteCalc();
      let total = perMin * avg;

      // 총액 가산 (자료화면 갯수 / 외부 오디오 / 믹싱 / 소스비율)
      // 자료화면 갯수
      if (els.hasBroll.value==='Y'){
        const c = Number(els.brollCount.value||0);
        if (c>=1 && c<=12){ total *= 1.20; }
        else if (c>=13 && c<=40){ total *= 1.45; }
        else if (c>=41){ total *= 1.65; }
      }

      // 외부 오디오트랙 유: 총액 +5%
      if (els.extAudio.value==='Y'){ total *= 1.05; }

      // 오디오 믹싱 간단: 총액 +20%
      if (els.mixing.value==='simple'){ total *= 1.20; }

      // 오디오 믹싱 연출: 분당 +4000(위에서 반영) 후 총액 +20%
      if (els.mixing.value==='balance'){ total *= 1.20; }

      // 원본소스 시간 비율 가산: (원본 분 / 편집 평균분)
      const h = Number(els.srcHour.value||0);
      const m = Number(els.srcMin.value||0);
      const srcMins = h*60 + m;
      const ratio = avg > 0 ? (srcMins / avg) : 0;
      if (ratio >= 20) total *= 2.0; // +100%
      else if (ratio >= 10) total *= 1.5; // +50%
      else if (ratio >= 7) total *= 1.4; // +40%
      else if (ratio >= 5) total *= 1.2; // +20%
      // 2.5배 이하는 변경 없음

      return {total, perMin, base, add, avgMinutes: avg};
    }

    function easeOutCubic(t){ return 1 - Math.pow(1 - t, 3); }

    function openModal(finalTotal){
      els.modal.classList.remove('hidden');
      const duration = 1800; // ms
      const start = performance.now();
      const base = Math.max(10000, finalTotal * 0.6);
      function frame(now){
        const t = Math.min(1, (now - start)/duration);
        const eased = easeOutCubic(t);
        const jitter = (1-t) * (Math.random()*finalTotal*0.05);
        const current = Math.round(base + (finalTotal - base)*eased + jitter);
        els.roulette.textContent = current.toLocaleString('ko-KR') + '원';
        if (t < 1) requestAnimationFrame(frame); else els.roulette.textContent = finalTotal.toLocaleString('ko-KR') + '원';
      }
      requestAnimationFrame(frame);
    }

    function bind(){
      document.querySelectorAll('input,select').forEach(el => { el.addEventListener('input', totalCalc); el.addEventListener('change', totalCalc); });

      if (els.confirmBtn){
        els.confirmBtn.addEventListener('click', ()=>{
          const { total } = totalCalc();
          openModal(Math.round(total));
        });
      }
      if (els.closeModal){
        els.closeModal.addEventListener('click', ()=>{
          els.modal.classList.add('hidden');
        });
      }

      setBrollEnabled();
      totalCalc();
    }

    bind();
  </script>
</body>
</html>
